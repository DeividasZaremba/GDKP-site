{% extends 'base.html' %}
{% load week_filters %}
{% block content %}

<h1>GDKP Raids</h1>
{% if object_list %}
  {% with month=object_list.0.event_date|date:"F Y" %}
    {% with year=object_list.0.event_date|date:"Y" %}
      <h2>{{ month }}</h2>
    <table>
      <thead>
        <tr>
          <th>Mon</th>
          <th>Tue</th>
          <th>Wed</th>
          <th>Thu</th>
          <th>Fri</th>
          <th>Sat</th>
          <th>Sun</th>
        </tr>
      </thead>
      <tbody>
        {% for week in object_list|week_list %}
          <tr>
            {% if week %}
            {% for i in week|default:""|my_range:"7" %}
              {% with day=week.i.0 date=week.i.1 %}
                {% if day %}
                  <td>
                    <div class="day">
                      <div class="date">{{ date|date:"j" }}</div>
                      {% for event in day %}
                        <div class="event">
                          <a href="{% url 'event-detail' event.pk %}">{{ event.event_name }}</a>
                        </div>
                      {% empty %}
                        <div class="no-event"></div>
                      {% endfor %}
                    </div>
                  </td>
                {% else %}
                  <td>
                    <div class="day">
                      <div class="date">{{ i|add:"-6"|add:first_day|date:"j" }}</div>
                      <div class="no-event"></div>
                    </div>
                  </td>
                {% endif %}
              {% endwith %}
            {% endfor %}
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endwith %}
  {% endwith %}
{% else %}
  <p>No events yet.</p>
{% endif %}
{% endblock %}